# PingSpy
# PingSpy - ICMP Traffic Monitor  
**README**  

## Описание  
PingSpy — это инструмент для мониторинга и анализа ICMP-трафика в реальном времени. Программа обнаруживает подозрительную активность, такую как:  
- Необычно большие ICMP-пакеты  
- Высокая частота ICMP-запросов  
- Возможные ICMP-туннели (скрытая передача данных через ICMP)  

## Установка  
### Требования  
- Компилятор C++ с поддержкой C++11  
- Библиотека **libtins** (`libtins-dev`)  (sudo apt install libtins -dev -y)
- Права root/sudo для захвата пакетов  

### Сборка  
```bash
sudo apt install libtins -dev -y
g++ -std=c++11 pingspy.cpp -o pingspy -ltins
```

## Использование  
Запуск:  
```bash
sudo ./pingspy
```  

### Выбор интерфейса  
При запуске программа выведет список доступных сетевых интерфейсов. Укажите имя интерфейса (например, `eth0` или `wlan0`).  

### Основные команды  
| Команда | Описание |  
|---------|----------|  
| `do_report` | Сохранить дамп ICMP-трафика в файл `otchet.txt` |  
| `show_dump` | Показать последние перехваченные ICMP-пакеты |  
| `exit` | Завершить работу |  
| `help` | Справка по всем командам |  
| `settings` | Текущие настройки |  

### Настройки обнаружения  
| Параметр | Значение по умолчанию | Описание |  
|----------|----------------------|----------|  
| Нижний порог подозрительности | `3` | Минимальный уровень для предупреждения |  
| Верхний порог подозрительности | `7` | Уровень для критического предупреждения |  
| Размер подозрительного пакета | `128` байт | Пакеты больше этого размера считаются подозрительными |  
| Интервал анализа | `5000` мс | Частота проверки трафика |  

Изменить настройки можно командами:  
- `change_lower_level_of_susp_detection <значение>`  
- `change_upper_level_of_susp_detection <значение>`  
- `chint <интервал_в_мс>`  

### Экспорт/импорт настроек  
- `expsettings` — сохранить настройки в `pingspysettings.txt`  
- `impsettings` — загрузить настройки из файла  

## Примеры работы  
1. **Обычный режим**  
   ```bash
   sudo ./pingspy
   ```
   → Выбираем интерфейс `eth0`  
   → Вводим `show_dump` для просмотра трафика  

2. **Обнаружение аномалий**  
   При подозрительной активности программа выведет:  
   ```
   Extremely suspicious icmp activity has been detected.
   We recommend run an antivirus software check.
   suspicious level: 8
   ```

3. **Создание отчёта**  
   Введите `do_report`, чтобы сохранить дамп в `otchet.txt`.  

## Безопасность  
- Для мониторинга требуются права **root**.  
- Включённый `devmod` позволяет изменять настройки на небезопасные значения.  
- Программа может давать ложные срабатывания на легитимный трафик (например, ping с большими пакетами).  

## Лицензия  
BSD 2-Clause License (см. заголовок в исходном коде).  

---
**Примечание**:  
- Для мониторинга Wi-Fi трафика используйте интерфейс `wlan0`.  
- При обнаружении туннеля (`ICMP tunnel`) рекомендуется проверить систему на наличие вредоносного ПО.
